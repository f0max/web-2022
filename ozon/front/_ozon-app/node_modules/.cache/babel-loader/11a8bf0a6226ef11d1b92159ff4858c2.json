{"ast":null,"code":"var _jsxFileName = \"C:\\\\PycharmProjects\\\\lab4\\\\ozon-app\\\\src\\\\pages\\\\CartPage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { GetCart, GetProducts } from \"../contexts/provider\";\nimport \"../styles/CartPage.css\";\nimport { BACKEND_URL } from \"../contexts/provider\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction CartPage() {\n  _s();\n  const products = GetProducts();\n  const cart = GetCart(localStorage.getItem('user_id'));\n  useEffect(() => {\n    console.log(`Корзина пользователя ${localStorage.getItem('user_login')}`);\n    console.log(cart);\n  }, []);\n  const buy = () => {\n    let order;\n    const se = {\n      user: localStorage.getItem('user_id'),\n      status: 1\n    };\n    fetch(`${BACKEND_URL}/sell/`, {\n      method: \"post\",\n      headers: {\n        \"Authorization\": `Token ${sessionStorage.getItem('token')}`,\n        \"Content-Type\": \"application/json\"\n      },\n      withCredentials: true,\n      body: JSON.stringify(se)\n    }).then(res => res.json()).then(res => {\n      console.log(res);\n      order = res.id;\n    });\n    setTimeout(() => {\n      cart.map(cart => {\n        const ob = {\n          sell: order,\n          product: cart.product,\n          quantity: cart.quantity\n        };\n        fetch(`${BACKEND_URL}/purchase/`, {\n          method: \"post\",\n          headers: {\n            \"Authorization\": `Token ${sessionStorage.getItem('token')}`,\n            \"Content-Type\": \"application/json\"\n          },\n          withCredentials: true,\n          body: JSON.stringify(ob)\n        }).then(res => res.json()).then(res => {\n          console.log(res);\n        });\n        del(cart.id);\n      });\n    }, 50);\n  };\n  const del = id_product => {\n    console.log(id_product);\n    fetch(`${BACKEND_URL}/cart/${id_product}`, {\n      method: \"DELETE\",\n      headers: {\n        \"Authorization\": `Token ${sessionStorage.getItem('token')}`,\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(res => {\n      if (res.ok) {\n        console.log(\"HTTP request done\");\n        window.location.reload();\n      } else {\n        console.log(\"HTTP request error\");\n      }\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"a\", {\n      href: \"/\",\n      className: \"breadcrumbs\",\n      children: \"\\u0413\\u043B\\u0430\\u0432\\u043D\\u0430\\u044F/\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n      href: \"/cart\",\n      className: \"breadcrumbs\",\n      children: \"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cart_block\",\n      children: [cart.map(cart => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cart_line\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cart_image_block\",\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: `/product/${products[cart.id_product - products[0].id].id}`,\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                className: \"cart_image\",\n                src: `${products[cart.id_product - products[0].id].product_pic}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 93,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 92,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cart_title_block\",\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              className: \"cart_title\",\n              to: `/product/${products[cart.id_product - products[0].id].id}`,\n              children: products[cart.id_product - products[0].id].product_name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cart_price_block\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cart_price\",\n              children: [products[cart.id_product - products[0].id].product_price, \"  \\u20BD\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cart_delete_block\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              id: \"buy_button\",\n              className: \"delete_button\",\n              type: \"submit\",\n              value: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\",\n              onClick: () => {\n                del(cart.id);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 29\n          }, this)]\n        }, cart.id_product, true, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 21\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cart_buy_block\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"cart_buy_button\",\n          onClick: () => {\n            buy();\n          },\n          children: \"\\u041A\\u0443\\u043F\\u0438\\u0442\\u044C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 9\n  }, this);\n}\n_s(CartPage, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n_c = CartPage;\nexport default CartPage;\nvar _c;\n$RefreshReg$(_c, \"CartPage\");","map":{"version":3,"names":["React","useEffect","Link","GetCart","GetProducts","BACKEND_URL","CartPage","products","cart","localStorage","getItem","console","log","buy","order","se","user","status","fetch","method","headers","sessionStorage","withCredentials","body","JSON","stringify","then","res","json","id","setTimeout","map","ob","sell","product","quantity","del","id_product","ok","window","location","reload","product_pic","product_name","product_price"],"sources":["C:/PycharmProjects/lab4/ozon-app/src/pages/CartPage.js"],"sourcesContent":["import React, {useEffect} from \"react\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {GetCart, GetProducts} from \"../contexts/provider\";\r\nimport \"../styles/CartPage.css\";\r\nimport {BACKEND_URL} from \"../contexts/provider\"\r\n\r\n\r\nfunction CartPage() {\r\n    const products = GetProducts()\r\n    const cart = GetCart(localStorage.getItem('user_id'))\r\n\r\n    useEffect(() => {\r\n        console.log(`Корзина пользователя ${localStorage.getItem('user_login')}`)\r\n        console.log(cart);\r\n    }, [])\r\n\r\n    const buy=()=> {\r\n        let order;\r\n        const se = {\r\n            user: localStorage.getItem('user_id'),\r\n            status: 1,\r\n        }\r\n        fetch(`${BACKEND_URL}/sell/`, {\r\n            method: \"post\",\r\n            headers: {\r\n                \"Authorization\": `Token ${sessionStorage.getItem('token')}`,\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            withCredentials: true,\r\n            body: JSON.stringify(se)\r\n        })\r\n            .then(res => res.json())\r\n            .then(res => {\r\n                console.log(res)\r\n                order = res.id\r\n            })\r\n\r\n        setTimeout(() => {\r\n            cart.map(cart => {\r\n                const ob = {\r\n                    sell: order,\r\n                    product: cart.product,\r\n                    quantity: cart.quantity,\r\n                }\r\n                fetch(`${BACKEND_URL}/purchase/`, {\r\n                    method: \"post\",\r\n                    headers: {\r\n                        \"Authorization\": `Token ${sessionStorage.getItem('token')}`,\r\n                        \"Content-Type\": \"application/json\"\r\n                    },\r\n                    withCredentials: true,\r\n                    body: JSON.stringify(ob)\r\n                })\r\n                    .then(res => res.json())\r\n                    .then(res => {\r\n                        console.log(res);\r\n                    })\r\n                del(cart.id)\r\n            })\r\n        }, 50);\r\n    }\r\n\r\n    const del=(id_product)=> {\r\n        console.log(id_product)\r\n        fetch(`${BACKEND_URL}/cart/${id_product}`, {\r\n            method: \"DELETE\",\r\n            headers: {\r\n                \"Authorization\": `Token ${sessionStorage.getItem('token')}`,\r\n                \"Content-Type\": \"application/json\"\r\n            }\r\n        })\r\n            .then(res => {\r\n                if (res.ok) {\r\n                    console.log(\"HTTP request done\");\r\n                    window.location.reload();\r\n                } else {\r\n                    console.log(\"HTTP request error\");\r\n                }\r\n            })\r\n\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <a href=\"/\" className=\"breadcrumbs\">Главная/</a>\r\n            <a href=\"/cart\" className=\"breadcrumbs\">Корзина</a>\r\n            <div className=\"cart_block\">\r\n                {cart.map(cart =>\r\n                    <div>\r\n                        <div key = {cart.id_product} className=\"cart_line\">\r\n                            <div className=\"cart_image_block\">\r\n                                <Link to={`/product/${products[cart.id_product - products[0].id].id}`}>\r\n                                    <img className=\"cart_image\" src={`${products[cart.id_product - products[0].id].product_pic}`} />\r\n                                </Link>\r\n                            </div>\r\n                            <div className=\"cart_title_block\">\r\n                                <Link className=\"cart_title\" to={`/product/${products[cart.id_product - products[0].id].id}`}>\r\n                                    {products[cart.id_product - products[0].id].product_name}\r\n                                </Link>\r\n                            </div>\r\n                            <div className=\"cart_price_block\">\r\n                                <div className=\"cart_price\">\r\n                                    {products[cart.id_product - products[0].id].product_price}  ₽\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"cart_delete_block\">\r\n                                <input id=\"buy_button\" className=\"delete_button\" type=\"submit\" value=\"Удалить\" onClick={()=>{del(cart.id)}}/>\r\n                            </div>\r\n                        </div>\r\n                        <hr/>\r\n                    </div>)}\r\n                    <div className=\"cart_buy_block\">\r\n                        <button className=\"cart_buy_button\" onClick={()=>{buy()}}>Купить</button>\r\n                    </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\nexport default CartPage;"],"mappings":";;AAAA,OAAOA,KAAK,IAAGC,SAAS,QAAO,OAAO;AACtC,SAAQC,IAAI,QAAO,kBAAkB;AACrC,SAAQC,OAAO,EAAEC,WAAW,QAAO,sBAAsB;AACzD,OAAO,wBAAwB;AAC/B,SAAQC,WAAW,QAAO,sBAAsB;AAAA;AAGhD,SAASC,QAAQ,GAAG;EAAA;EAChB,MAAMC,QAAQ,GAAGH,WAAW,EAAE;EAC9B,MAAMI,IAAI,GAAGL,OAAO,CAACM,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC,CAAC;EAErDT,SAAS,CAAC,MAAM;IACZU,OAAO,CAACC,GAAG,CAAE,wBAAuBH,YAAY,CAACC,OAAO,CAAC,YAAY,CAAE,EAAC,CAAC;IACzEC,OAAO,CAACC,GAAG,CAACJ,IAAI,CAAC;EACrB,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMK,GAAG,GAAC,MAAK;IACX,IAAIC,KAAK;IACT,MAAMC,EAAE,GAAG;MACPC,IAAI,EAAEP,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;MACrCO,MAAM,EAAE;IACZ,CAAC;IACDC,KAAK,CAAE,GAAEb,WAAY,QAAO,EAAE;MAC1Bc,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACL,eAAe,EAAG,SAAQC,cAAc,CAACX,OAAO,CAAC,OAAO,CAAE,EAAC;QAC3D,cAAc,EAAE;MACpB,CAAC;MACDY,eAAe,EAAE,IAAI;MACrBC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACV,EAAE;IAC3B,CAAC,CAAC,CACGW,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACC,IAAI,EAAE,CAAC,CACvBF,IAAI,CAACC,GAAG,IAAI;MACThB,OAAO,CAACC,GAAG,CAACe,GAAG,CAAC;MAChBb,KAAK,GAAGa,GAAG,CAACE,EAAE;IAClB,CAAC,CAAC;IAENC,UAAU,CAAC,MAAM;MACbtB,IAAI,CAACuB,GAAG,CAACvB,IAAI,IAAI;QACb,MAAMwB,EAAE,GAAG;UACPC,IAAI,EAAEnB,KAAK;UACXoB,OAAO,EAAE1B,IAAI,CAAC0B,OAAO;UACrBC,QAAQ,EAAE3B,IAAI,CAAC2B;QACnB,CAAC;QACDjB,KAAK,CAAE,GAAEb,WAAY,YAAW,EAAE;UAC9Bc,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YACL,eAAe,EAAG,SAAQC,cAAc,CAACX,OAAO,CAAC,OAAO,CAAE,EAAC;YAC3D,cAAc,EAAE;UACpB,CAAC;UACDY,eAAe,EAAE,IAAI;UACrBC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACO,EAAE;QAC3B,CAAC,CAAC,CACGN,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACC,IAAI,EAAE,CAAC,CACvBF,IAAI,CAACC,GAAG,IAAI;UACThB,OAAO,CAACC,GAAG,CAACe,GAAG,CAAC;QACpB,CAAC,CAAC;QACNS,GAAG,CAAC5B,IAAI,CAACqB,EAAE,CAAC;MAChB,CAAC,CAAC;IACN,CAAC,EAAE,EAAE,CAAC;EACV,CAAC;EAED,MAAMO,GAAG,GAAEC,UAAU,IAAI;IACrB1B,OAAO,CAACC,GAAG,CAACyB,UAAU,CAAC;IACvBnB,KAAK,CAAE,GAAEb,WAAY,SAAQgC,UAAW,EAAC,EAAE;MACvClB,MAAM,EAAE,QAAQ;MAChBC,OAAO,EAAE;QACL,eAAe,EAAG,SAAQC,cAAc,CAACX,OAAO,CAAC,OAAO,CAAE,EAAC;QAC3D,cAAc,EAAE;MACpB;IACJ,CAAC,CAAC,CACGgB,IAAI,CAACC,GAAG,IAAI;MACT,IAAIA,GAAG,CAACW,EAAE,EAAE;QACR3B,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;QAChC2B,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE;MAC5B,CAAC,MAAM;QACH9B,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;MACrC;IACJ,CAAC,CAAC;EAEV,CAAC;EAED,oBACI;IAAA,wBACI;MAAG,IAAI,EAAC,GAAG;MAAC,SAAS,EAAC,aAAa;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QAAa,eAChD;MAAG,IAAI,EAAC,OAAO;MAAC,SAAS,EAAC,aAAa;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QAAY,eACnD;MAAK,SAAS,EAAC,YAAY;MAAA,WACtBJ,IAAI,CAACuB,GAAG,CAACvB,IAAI,iBACV;QAAA,wBACI;UAA6B,SAAS,EAAC,WAAW;UAAA,wBAC9C;YAAK,SAAS,EAAC,kBAAkB;YAAA,uBAC7B,QAAC,IAAI;cAAC,EAAE,EAAG,YAAWD,QAAQ,CAACC,IAAI,CAAC6B,UAAU,GAAG9B,QAAQ,CAAC,CAAC,CAAC,CAACsB,EAAE,CAAC,CAACA,EAAG,EAAE;cAAA,uBAClE;gBAAK,SAAS,EAAC,YAAY;gBAAC,GAAG,EAAG,GAAEtB,QAAQ,CAACC,IAAI,CAAC6B,UAAU,GAAG9B,QAAQ,CAAC,CAAC,CAAC,CAACsB,EAAE,CAAC,CAACa,WAAY;cAAE;gBAAA;gBAAA;gBAAA;cAAA;YAAG;cAAA;cAAA;cAAA;YAAA;UAC7F;YAAA;YAAA;YAAA;UAAA,QACL,eACN;YAAK,SAAS,EAAC,kBAAkB;YAAA,uBAC7B,QAAC,IAAI;cAAC,SAAS,EAAC,YAAY;cAAC,EAAE,EAAG,YAAWnC,QAAQ,CAACC,IAAI,CAAC6B,UAAU,GAAG9B,QAAQ,CAAC,CAAC,CAAC,CAACsB,EAAE,CAAC,CAACA,EAAG,EAAE;cAAA,UACxFtB,QAAQ,CAACC,IAAI,CAAC6B,UAAU,GAAG9B,QAAQ,CAAC,CAAC,CAAC,CAACsB,EAAE,CAAC,CAACc;YAAY;cAAA;cAAA;cAAA;YAAA;UACrD;YAAA;YAAA;YAAA;UAAA,QACL,eACN;YAAK,SAAS,EAAC,kBAAkB;YAAA,uBAC7B;cAAK,SAAS,EAAC,YAAY;cAAA,WACtBpC,QAAQ,CAACC,IAAI,CAAC6B,UAAU,GAAG9B,QAAQ,CAAC,CAAC,CAAC,CAACsB,EAAE,CAAC,CAACe,aAAa;YAAA;cAAA;cAAA;cAAA;YAAA;UACvD;YAAA;YAAA;YAAA;UAAA,QACJ,eACN;YAAK,SAAS,EAAC,mBAAmB;YAAA,uBAC9B;cAAO,EAAE,EAAC,YAAY;cAAC,SAAS,EAAC,eAAe;cAAC,IAAI,EAAC,QAAQ;cAAC,KAAK,EAAC,4CAAS;cAAC,OAAO,EAAE,MAAI;gBAACR,GAAG,CAAC5B,IAAI,CAACqB,EAAE,CAAC;cAAA;YAAE;cAAA;cAAA;cAAA;YAAA;UAAE;YAAA;YAAA;YAAA;UAAA,QAC3G;QAAA,GAlBErB,IAAI,CAAC6B,UAAU;UAAA;UAAA;UAAA;QAAA,QAmBrB,eACN;UAAA;UAAA;UAAA;QAAA,QAAK;MAAA;QAAA;QAAA;QAAA;MAAA,QACH,CAAC,eACP;QAAK,SAAS,EAAC,gBAAgB;QAAA,uBAC3B;UAAQ,SAAS,EAAC,iBAAiB;UAAC,OAAO,EAAE,MAAI;YAACxB,GAAG,EAAE;UAAA,CAAE;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA;MAAgB;QAAA;QAAA;QAAA;MAAA,QACvE;IAAA;MAAA;MAAA;MAAA;IAAA,QACR;EAAA;IAAA;IAAA;IAAA;EAAA,QACJ;AAEd;AAAC,GA9GQP,QAAQ;AAAA,KAARA,QAAQ;AA+GjB,eAAeA,QAAQ;AAAC;AAAA"},"metadata":{},"sourceType":"module"}