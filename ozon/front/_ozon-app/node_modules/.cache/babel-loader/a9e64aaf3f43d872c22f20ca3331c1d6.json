{"ast":null,"code":"var _jsxFileName = \"C:\\\\PycharmProjects\\\\lab4\\\\ozon-app\\\\src\\\\pages\\\\CartPage.js\";\nimport React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { GetCart, GetProducts } from \"../contexts/provider\";\nimport \"../styles/CartPage.css\";\nimport { BACKEND_URL } from \"../contexts/provider\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction CartPage() {\n  const products = GetProducts();\n  const cart = GetCart(localStorage.getItem('user_id'));\n  const buy = () => {\n    let order;\n    const se = {\n      user: localStorage.getItem('user_id'),\n      status: 1\n    };\n    fetch(`${BACKEND_URL}/sell/`, {\n      method: \"post\",\n      headers: {\n        \"Authorization\": `Token ${sessionStorage.getItem('token')}`,\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(se)\n    }).then(res => res.json()).then(res => {\n      console.log(res);\n      order = res.id;\n    });\n    setTimeout(() => {\n      cart.map(cart => {\n        const ob = {\n          sell: order,\n          product: cart.id_product,\n          quantity: cart.quantity\n        };\n        fetch(`${BACKEND_URL}/purchase/`, {\n          method: \"post\",\n          headers: {\n            \"Authorization\": `Token ${sessionStorage.getItem('token')}`,\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify(ob)\n        }).then(res => res.json()).then(res => {\n          console.log(res);\n        });\n        del(cart.id);\n      });\n    }, 50);\n  };\n  const del = cartID => {\n    fetch(`${BACKEND_URL}/cart/${cartID}`, {\n      method: \"DELETE\",\n      headers: {\n        \"Authorization\": `Token ${sessionStorage.getItem('token')}`,\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(res => {\n      if (res.ok) {\n        console.log(\"HTTP request done\");\n        window.location.reload();\n      } else {\n        console.log(\"HTTP request error\");\n      }\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"a\", {\n      href: \"/\",\n      className: \"breadcrumbs\",\n      children: \"\\u0413\\u043B\\u0430\\u0432\\u043D\\u0430\\u044F/\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n      href: \"/cart\",\n      className: \"breadcrumbs\",\n      children: \"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cart_block\",\n      children: [cart.map(cart => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cart_line\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cart_image_block\",\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: `/product/${products[cart.id_product - products[0].id].id}`,\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                className: \"cart_image\",\n                src: `${products[cart.id_product - products[0].id].product_pic}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 85,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cart_title_block\",\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              className: \"cart_title\",\n              to: `/product/${products[cart.id_product - products[0].id].id}`,\n              children: products[cart.id_product - products[0].id].product_name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cart_price_block\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cart_price\",\n              children: [products[cart.id_product - products[0].id].product_price * products[cart.id_product - products[0].id.quantity], \" \\u20BD\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cart_delete_block\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              id: \"buy_button\",\n              className: \"delete_button\",\n              type: \"submit\",\n              value: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\",\n              onClick: () => {\n                del(cart.id);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 29\n          }, this)]\n        }, cart.id_product, true, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 21\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cart_buy_block\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"cart_buy_button\",\n          onClick: () => {\n            buy();\n          },\n          children: \"\\u041A\\u0443\\u043F\\u0438\\u0442\\u044C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 9\n  }, this);\n}\n_c = CartPage;\nexport default CartPage;\nvar _c;\n$RefreshReg$(_c, \"CartPage\");","map":{"version":3,"names":["React","Link","GetCart","GetProducts","BACKEND_URL","CartPage","products","cart","localStorage","getItem","buy","order","se","user","status","fetch","method","headers","sessionStorage","body","JSON","stringify","then","res","json","console","log","id","setTimeout","map","ob","sell","product","id_product","quantity","del","cartID","ok","window","location","reload","product_pic","product_name","product_price"],"sources":["C:/PycharmProjects/lab4/ozon-app/src/pages/CartPage.js"],"sourcesContent":["import React from \"react\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {GetCart, GetProducts} from \"../contexts/provider\";\r\nimport \"../styles/CartPage.css\";\r\nimport {BACKEND_URL} from \"../contexts/provider\"\r\n\r\n\r\nfunction CartPage() {\r\n    const products = GetProducts()\r\n    const cart = GetCart(localStorage.getItem('user_id'))\r\n\r\n    const buy=()=> {\r\n        let order;\r\n        const se = {\r\n            user: localStorage.getItem('user_id'),\r\n            status: 1,\r\n        }\r\n        fetch(`${BACKEND_URL}/sell/`, {\r\n            method: \"post\",\r\n            headers: {\r\n                \"Authorization\": `Token ${sessionStorage.getItem('token')}`,\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify(se)\r\n        })\r\n            .then(res => res.json())\r\n            .then(res => {\r\n                console.log(res)\r\n                order = res.id\r\n            })\r\n\r\n        setTimeout(() => {\r\n            cart.map(cart => {\r\n                const ob = {\r\n                    sell: order,\r\n                    product: cart.id_product,\r\n                    quantity: cart.quantity,\r\n                }\r\n                fetch(`${BACKEND_URL}/purchase/`, {\r\n                    method: \"post\",\r\n                    headers: {\r\n                        \"Authorization\": `Token ${sessionStorage.getItem('token')}`,\r\n                        \"Content-Type\": \"application/json\"\r\n                    },\r\n                    body: JSON.stringify(ob)\r\n                })\r\n                    .then(res => res.json())\r\n                    .then(res => {\r\n                        console.log(res);\r\n                    })\r\n                del(cart.id)\r\n            })\r\n        }, 50);\r\n    }\r\n\r\n    const del=(cartID)=> {\r\n        fetch(`${BACKEND_URL}/cart/${cartID}`, {\r\n            method: \"DELETE\",\r\n            headers: {\r\n                \"Authorization\": `Token ${sessionStorage.getItem('token')}`,\r\n                \"Content-Type\": \"application/json\"\r\n            }\r\n        })\r\n            .then(res => {\r\n                if (res.ok) {\r\n                    console.log(\"HTTP request done\");\r\n                    window.location.reload();\r\n                } else {\r\n                    console.log(\"HTTP request error\");\r\n                }\r\n            })\r\n\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <a href=\"/\" className=\"breadcrumbs\">Главная/</a>\r\n            <a href=\"/cart\" className=\"breadcrumbs\">Корзина</a>\r\n            <div className=\"cart_block\">\r\n                {cart.map(cart =>\r\n                    <div>\r\n                        <div key = {cart.id_product} className=\"cart_line\">\r\n                            <div className=\"cart_image_block\">\r\n                                <Link to={`/product/${products[cart.id_product - products[0].id].id}`}>\r\n                                    <img className=\"cart_image\" src={`${products[cart.id_product - products[0].id].product_pic}`} />\r\n                                </Link>\r\n                            </div>\r\n                            <div className=\"cart_title_block\">\r\n                                <Link className=\"cart_title\" to={`/product/${products[cart.id_product - products[0].id].id}`}>\r\n                                    {products[cart.id_product - products[0].id].product_name}\r\n                                </Link>\r\n                            </div>\r\n                            <div className=\"cart_price_block\">\r\n                                <div className=\"cart_price\">\r\n                                    {products[cart.id_product - products[0].id].product_price * products[cart.id_product - products[0].id.quantity]} ₽\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"cart_delete_block\">\r\n                                <input id=\"buy_button\" className=\"delete_button\" type=\"submit\" value=\"Удалить\" onClick={()=>{del(cart.id)}}/>\r\n                            </div>\r\n                        </div>\r\n                        <hr/>\r\n                    </div>)}\r\n                    <div className=\"cart_buy_block\">\r\n                        <button className=\"cart_buy_button\" onClick={()=>{buy()}}>Купить</button>\r\n                    </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\nexport default CartPage;"],"mappings":"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"},"metadata":{},"sourceType":"module"}